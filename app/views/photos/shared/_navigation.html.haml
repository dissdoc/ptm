%div#navigation
  %ul
    %li
      - if signed_in?
        -# Favorites menu
        - unless current_user.admin_of_photo?(photo)
          %div#favorites
            = render :partial => 'favorites/shared/fave', :locals => { :photo => photo }

    %li
      %div
        %a{ :href => "https://twitter.com/share",
            :class => "twitter-share-button",
            "data-text" => "About this photo: #{photo.comment}",
            "data-url" => "http://phototimemachine.heroku.com#{photo_path(photo)}",
            "data-count" => "none" }
          Tweet
        :javascript
          !function(d,s,id) {
            var js,fjs=d.getElementsByTagName(s)[0];
            if(!d.getElementById(id)) {
              js=d.createElement(s);
              js.id=id;
              js.src="//platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js,fjs);
            }
          }(document,"script","twitter-wjs");

    %li
      %div#vk_like_button
      :javascript
        document.getElementById('vk_like_button').innerHTML = VK.Share.button(
          {
            url: "http://phototimemachine.heroku.com#{photo_path(photo)}",
            title: "Photo",
            image: "#{photo.image.url(:medium)}",
            noparse: true
          },
          {
            type: 'custom',
            text: '<img src="/assets/ICON_bLIKE.jpg" />'
          });

    %li
      %div{ :class => "fb-like", "data-href" => "http://phototimemachine.heroku.com#{photo_path(photo)}",
                "data-send" => "false", "data-layout" => "button_count", "data-width" => "100",
                "data-show-faces" => "false", "data-action" => "like", "data-font" => "arial" }
      :javascript
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=284172994996972";
            fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));

    - if signed_in?
      %li
        %div.dropdown
          = link_to 'Action', '#', :remote => true
          %ul
            %li
              %div= link_to 'Add a note', '#', :id => 'addnotelink'
            %li
              %div= link_to 'Add to an album', '#', 'data-reveal-id' => 'modalAlbum', :remote => true
            %li
              %div= link_to 'Add to a group', '#', 'data-reveal-id' => "modalGroup", :remote => true
            %li
              %div= link_to 'Download'
            %li
              %div= link_to 'View original size', original_photo_path(photo)
            %li
              %div= link_to 'Replace'
            - if current_user.admin_of_photo?(photo)
              %li
                %div= link_to 'Delete', photo, :method => :delete
          %script{ :type => "text/javascript", :src => "/assets/ptm.dropdown.js" }
          :javascript
            $(document).ready(function() {
              $('.dropdown').ptmDropdown();
            });

      %li
        %div= link_to 'Share'

    %li{ :style => 'padding-left: 100px;' }
      = render 'shared/controls'


%div.clear

%div#modalGroup.reveal-modal
  %h4 Change group for add
  %a{ :class => "close-reveal-modal" }
    &#215;

  - if signed_in?
    - current_user.managing_groups.each do |group|
      %div= link_to group.name, group_link_photo_path(:group_id => group, :photo_id => @photo), :method => :post
    - current_user.joining_groups.each do |group|
      %div= link_to group.name, group_link_photo_path(:group_id => group, :photo_id => @photo), :method => :post

:javascript
  $('#modalGroup').reveal({
    animation: 'none',
    animationspeed: 200,
    closeOnBackgroundClick: true,
    dissmissModalClass: 'close-reveal-modal'
  });


%div#modalAlbum.reveal-modal
  %h4 Change album for add
  %a{ :class => 'close-reveal-modal' }
    &#215;

  - if signed_in?
    - current_user.assortments.each do |assortment|
      %div= link_to assortment.name, assortment_add_photo_path(:assortment_id => assortment, :photo_id => photo), :method => :post

:javascript
  $('#modalAlbum').reveal({
    animation: 'none',
    animationspeed: 200,
    closeOnBackgroundClick: true,
    dissmissModalClass: 'close-reveal-modal'
  });